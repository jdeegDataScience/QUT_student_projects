# import pandas as pd
# import numpy as np

def preprocess_music_data(raw_music_data):
    # drop unnecessary features
    preprocess_df = raw_music_data.drop(columns = ['ID', 'Type', 'Name'])
    
    # replace blank strings with NaN, typecast to float
    preprocess_df['Energy'] = preprocess_df['Energy'].replace('', np.nan).astype(float)
    preprocess_df['Loudness'] = preprocess_df['Loudness'].replace('', np.nan).astype(float)
    preprocess_df['Instrumentalness'] = preprocess_df['Instrumentalness'].replace('', np.nan).astype(float)
    
    # drop duplicate rows 
    preprocess_df.drop_duplicates(inplace = True)
    
    # drop outliers / beyond permissible range
    preprocess_df = preprocess_df[preprocess_df.Energy <= 1]
    preprocess_df = preprocess_df[preprocess_df.Instrumentalness <= 1]
    preprocess_df = preprocess_df[preprocess_df.Speechiness <= 1]
    
    return preprocess_df
